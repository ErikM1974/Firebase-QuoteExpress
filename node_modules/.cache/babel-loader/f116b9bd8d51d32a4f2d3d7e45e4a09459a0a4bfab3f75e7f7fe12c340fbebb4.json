{"ast":null,"code":"import React,{useState,useEffect}from'react';import AsyncSelect from'react-select/async';import{db}from'../firebase';import{collection,getDocs,query,limit,orderBy,startAt,endAt}from'firebase/firestore';import{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";export default function EmbroideryCalculator(){const[orders,setOrders]=useState([{styleNo:'',colorName:'',productTitle:'',productData:null,quantities:{},otherQuantity:0}]);const[errorMessage,setErrorMessage]=useState('');const[isLoading,setIsLoading]=useState(false);const MAIN_SIZES=['XS','S','M','L','XL','2XL','3XL','4XL','5XL'];useEffect(()=>{console.log('Orders updated:',orders);},[orders]);useEffect(()=>{// Check if Firebase is initialized correctly\nif(!db){console.error('Firestore db is not initialized');setErrorMessage('Firebase initialization failed. Please check your configuration.');}},[]);const loadStyleOptions=async inputValue=>{try{setIsLoading(true);const searchTerm=inputValue.toUpperCase();console.log('Searching for styles with input:',searchTerm);if(!db){throw new Error('Firestore db is not initialized');}const stylesRef=collection(db,'styles');const styleQuery=query(stylesRef,orderBy('styleNo'),startAt(searchTerm),endAt(searchTerm+'\\uf8ff'),limit(20));const querySnapshot=await getDocs(styleQuery);console.log('Query snapshot size:',querySnapshot.size);const styles=[];querySnapshot.forEach(doc=>{const data=doc.data();const styleNo=data.styleNo;console.log('Document ID:',doc.id,'Data:',data);if(styleNo&&data.productTitle){styles.push({label:`${styleNo} - ${data.productTitle}`,value:doc.id});}});console.log('Styles:',styles);return styles;}catch(err){console.error('Error loading styles:',err);setErrorMessage(`Error loading styles: ${err.message}`);return[];}finally{setIsLoading(false);}};const updateOrder=(index,field,value)=>{setOrders(prevOrders=>{const updatedOrders=[...prevOrders];updatedOrders[index]={...updatedOrders[index],[field]:value};return updatedOrders;});};// ... rest of the component code remains the same\nreturn/*#__PURE__*/_jsx(\"div\",{className:\"bg-gray-100 min-h-screen p-4\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"max-w-7xl mx-auto bg-white rounded-lg shadow-lg overflow-hidden\",children:[/*#__PURE__*/_jsx(\"h1\",{className:\"text-2xl font-bold text-green-600 p-4 bg-green-100\",children:\"Embroidery Order Form\"}),errorMessage&&/*#__PURE__*/_jsxs(\"div\",{className:\"bg-red-100 border-l-4 border-red-500 text-red-700 p-3 mb-4\",role:\"alert\",children:[/*#__PURE__*/_jsx(\"p\",{className:\"font-bold\",children:\"Error\"}),/*#__PURE__*/_jsx(\"p\",{children:errorMessage})]}),isLoading&&/*#__PURE__*/_jsx(\"div\",{children:\"Loading...\"}),/*#__PURE__*/_jsx(\"div\",{className:\"overflow-x-auto\",children:/*#__PURE__*/_jsxs(\"table\",{className:\"w-full text-sm\",children:[/*#__PURE__*/_jsx(\"thead\",{className:\"bg-green-500 text-white\",children:/*#__PURE__*/_jsxs(\"tr\",{children:[/*#__PURE__*/_jsx(\"th\",{className:\"p-2 text-left\",style:{width:'200px'},children:\"Style No\"}),/*#__PURE__*/_jsx(\"th\",{className:\"p-2 text-left\",children:\"Color\"}),/*#__PURE__*/_jsx(\"th\",{className:\"p-2 text-left\",children:\"Product Title\"}),MAIN_SIZES.map(size=>/*#__PURE__*/_jsx(\"th\",{className:\"p-2 text-center\",children:size},size)),/*#__PURE__*/_jsx(\"th\",{className:\"p-2 text-center\",children:\"Other\"}),/*#__PURE__*/_jsx(\"th\",{className:\"p-2 text-center\",children:\"Qty\"}),/*#__PURE__*/_jsx(\"th\",{className:\"p-2 text-center\",children:\"Total\"}),/*#__PURE__*/_jsx(\"th\",{className:\"p-2 text-center\",children:\"Actions\"})]})}),/*#__PURE__*/_jsx(\"tbody\",{children:orders.map((order,index)=>/*#__PURE__*/_jsx(\"tr\",{className:index%2===0?'bg-gray-50':'bg-white',children:/*#__PURE__*/_jsx(\"td\",{className:\"p-2\",style:{width:'200px'},children:/*#__PURE__*/_jsx(AsyncSelect,{cacheOptions:true,loadOptions:loadStyleOptions,onChange:selectedOption=>{const docId=selectedOption?selectedOption.value:'';updateOrder(index,'styleNo',docId);updateOrder(index,'colorName','');updateOrder(index,'productTitle','');updateOrder(index,'productData',null);},value:order.styleNo?{value:order.styleNo,label:`${order.styleNo} - ${order.productTitle}`}:null,placeholder:\"Enter style number\",isDisabled:isLoading,styles:{control:provided=>({...provided,minWidth:'200px'}),menu:provided=>({...provided,zIndex:9999})}})})},order.styleNo||index))})]})})]})});}","map":{"version":3,"names":["React","useState","useEffect","AsyncSelect","db","collection","getDocs","query","limit","orderBy","startAt","endAt","jsx","_jsx","jsxs","_jsxs","EmbroideryCalculator","orders","setOrders","styleNo","colorName","productTitle","productData","quantities","otherQuantity","errorMessage","setErrorMessage","isLoading","setIsLoading","MAIN_SIZES","console","log","error","loadStyleOptions","inputValue","searchTerm","toUpperCase","Error","stylesRef","styleQuery","querySnapshot","size","styles","forEach","doc","data","id","push","label","value","err","message","updateOrder","index","field","prevOrders","updatedOrders","className","children","role","style","width","map","order","cacheOptions","loadOptions","onChange","selectedOption","docId","placeholder","isDisabled","control","provided","minWidth","menu","zIndex"],"sources":["C:/Users/erik/Downloads/embroidered-order-form/src/components/EmbroideryCalculator.js"],"sourcesContent":["import React, { useState, useEffect } from 'react';\r\nimport AsyncSelect from 'react-select/async';\r\nimport { db } from '../firebase';\r\nimport {\r\n  collection,\r\n  getDocs,\r\n  query,\r\n  limit,\r\n  orderBy,\r\n  startAt,\r\n  endAt,\r\n} from 'firebase/firestore';\r\n\r\nexport default function EmbroideryCalculator() {\r\n  const [orders, setOrders] = useState([\r\n    {\r\n      styleNo: '',\r\n      colorName: '',\r\n      productTitle: '',\r\n      productData: null,\r\n      quantities: {},\r\n      otherQuantity: 0,\r\n    },\r\n  ]);\r\n  const [errorMessage, setErrorMessage] = useState('');\r\n  const [isLoading, setIsLoading] = useState(false);\r\n\r\n  const MAIN_SIZES = ['XS', 'S', 'M', 'L', 'XL', '2XL', '3XL', '4XL', '5XL'];\r\n\r\n  useEffect(() => {\r\n    console.log('Orders updated:', orders);\r\n  }, [orders]);\r\n\r\n  useEffect(() => {\r\n    // Check if Firebase is initialized correctly\r\n    if (!db) {\r\n      console.error('Firestore db is not initialized');\r\n      setErrorMessage('Firebase initialization failed. Please check your configuration.');\r\n    }\r\n  }, []);\r\n\r\n  const loadStyleOptions = async (inputValue) => {\r\n    try {\r\n      setIsLoading(true);\r\n      const searchTerm = inputValue.toUpperCase();\r\n      console.log('Searching for styles with input:', searchTerm);\r\n\r\n      if (!db) {\r\n        throw new Error('Firestore db is not initialized');\r\n      }\r\n\r\n      const stylesRef = collection(db, 'styles');\r\n\r\n      const styleQuery = query(\r\n        stylesRef,\r\n        orderBy('styleNo'),\r\n        startAt(searchTerm),\r\n        endAt(searchTerm + '\\uf8ff'),\r\n        limit(20)\r\n      );\r\n\r\n      const querySnapshot = await getDocs(styleQuery);\r\n      console.log('Query snapshot size:', querySnapshot.size);\r\n\r\n      const styles = [];\r\n      querySnapshot.forEach((doc) => {\r\n        const data = doc.data();\r\n        const styleNo = data.styleNo;\r\n        console.log('Document ID:', doc.id, 'Data:', data);\r\n        if (styleNo && data.productTitle) {\r\n          styles.push({ label: `${styleNo} - ${data.productTitle}`, value: doc.id });\r\n        }\r\n      });\r\n\r\n      console.log('Styles:', styles);\r\n      return styles;\r\n    } catch (err) {\r\n      console.error('Error loading styles:', err);\r\n      setErrorMessage(`Error loading styles: ${err.message}`);\r\n      return [];\r\n    } finally {\r\n      setIsLoading(false);\r\n    }\r\n  };\r\n\r\n  const updateOrder = (index, field, value) => {\r\n    setOrders((prevOrders) => {\r\n      const updatedOrders = [...prevOrders];\r\n      updatedOrders[index] = {\r\n        ...updatedOrders[index],\r\n        [field]: value,\r\n      };\r\n      return updatedOrders;\r\n    });\r\n  };\r\n\r\n  // ... rest of the component code remains the same\r\n\r\n  return (\r\n    <div className=\"bg-gray-100 min-h-screen p-4\">\r\n      <div className=\"max-w-7xl mx-auto bg-white rounded-lg shadow-lg overflow-hidden\">\r\n        <h1 className=\"text-2xl font-bold text-green-600 p-4 bg-green-100\">\r\n          Embroidery Order Form\r\n        </h1>\r\n        {errorMessage && (\r\n          <div\r\n            className=\"bg-red-100 border-l-4 border-red-500 text-red-700 p-3 mb-4\"\r\n            role=\"alert\"\r\n          >\r\n            <p className=\"font-bold\">Error</p>\r\n            <p>{errorMessage}</p>\r\n          </div>\r\n        )}\r\n        {isLoading && <div>Loading...</div>}\r\n        <div className=\"overflow-x-auto\">\r\n          <table className=\"w-full text-sm\">\r\n            <thead className=\"bg-green-500 text-white\">\r\n              <tr>\r\n                <th className=\"p-2 text-left\" style={{ width: '200px' }}>\r\n                  Style No\r\n                </th>\r\n                <th className=\"p-2 text-left\">Color</th>\r\n                <th className=\"p-2 text-left\">Product Title</th>\r\n                {MAIN_SIZES.map((size) => (\r\n                  <th key={size} className=\"p-2 text-center\">\r\n                    {size}\r\n                  </th>\r\n                ))}\r\n                <th className=\"p-2 text-center\">Other</th>\r\n                <th className=\"p-2 text-center\">Qty</th>\r\n                <th className=\"p-2 text-center\">Total</th>\r\n                <th className=\"p-2 text-center\">Actions</th>\r\n              </tr>\r\n            </thead>\r\n            <tbody>\r\n              {orders.map((order, index) => (\r\n                <tr\r\n                  key={order.styleNo || index}\r\n                  className={index % 2 === 0 ? 'bg-gray-50' : 'bg-white'}\r\n                >\r\n                  <td className=\"p-2\" style={{ width: '200px' }}>\r\n                    <AsyncSelect\r\n                      cacheOptions\r\n                      loadOptions={loadStyleOptions}\r\n                      onChange={(selectedOption) => {\r\n                        const docId = selectedOption ? selectedOption.value : '';\r\n                        updateOrder(index, 'styleNo', docId);\r\n                        updateOrder(index, 'colorName', '');\r\n                        updateOrder(index, 'productTitle', '');\r\n                        updateOrder(index, 'productData', null);\r\n                      }}\r\n                      value={\r\n                        order.styleNo\r\n                          ? {\r\n                              value: order.styleNo,\r\n                              label: `${order.styleNo} - ${order.productTitle}`,\r\n                            }\r\n                          : null\r\n                      }\r\n                      placeholder=\"Enter style number\"\r\n                      isDisabled={isLoading}\r\n                      styles={{\r\n                        control: (provided) => ({ ...provided, minWidth: '200px' }),\r\n                        menu: (provided) => ({ ...provided, zIndex: 9999 }),\r\n                      }}\r\n                    />\r\n                  </td>\r\n                  {/* ... rest of the row content */}\r\n                </tr>\r\n              ))}\r\n            </tbody>\r\n          </table>\r\n        </div>\r\n        {/* ... rest of the component JSX */}\r\n      </div>\r\n    </div>\r\n  );\r\n}\r\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}