{"ast":null,"code":"var _jsxFileName = \"C:\\\\Users\\\\erik\\\\Downloads\\\\embroidered-order-form\\\\src\\\\components\\\\EmbroideryCalculator.js\",\n  _s = $RefreshSig$();\nimport React, { useState, useCallback, useMemo, useEffect } from 'react';\nimport axios from 'axios';\nimport AsyncSelect from 'react-select/async';\nimport debounce from 'lodash/debounce';\nimport './EmbroideryCalculator.css';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nconst API_BASE_URL = 'https://c3eku948.caspio.com/rest/v2/views/Heroku/records';\nconst MAIN_SIZES = ['S', 'M', 'L', 'XL', '2XL', '3XL'];\nconst LARGE_SIZES = ['2XL', '3XL', '4XL', '5XL', '6XL'];\nconst LoadingSpinner = () => /*#__PURE__*/_jsxDEV(\"div\", {\n  className: \"loading-spinner\",\n  children: /*#__PURE__*/_jsxDEV(\"div\", {\n    className: \"spinner\"\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 13,\n    columnNumber: 5\n  }, this)\n}, void 0, false, {\n  fileName: _jsxFileName,\n  lineNumber: 12,\n  columnNumber: 3\n}, this);\n_c = LoadingSpinner;\nconst getPriceForQuantity = (product, totalQuantity) => {\n  console.log('Calculating price for quantity:', totalQuantity);\n  if (totalQuantity >= 72) return parseFloat(product.Price_72_plus) || 0;\n  if (totalQuantity >= 48) return parseFloat(product.Price_48_71) || 0;\n  if (totalQuantity >= 24) return parseFloat(product.Price_24_47) || 0;\n  if (totalQuantity >= 12) return parseFloat(product.Price_12_23) || 0;\n  if (totalQuantity >= 6) return parseFloat(product.Price_6_11) || 0;\n  return parseFloat(product.Price_2_5) || 0;\n};\nexport default function EmbroideryCalculator() {\n  _s();\n  const [productDatabase, setProductDatabase] = useState({});\n  const [orders, setOrders] = useState([{\n    STYLE_No: '',\n    COLOR_NAME: '',\n    quantities: {},\n    error: null\n  }]);\n  const [colors, setColors] = useState({});\n  const [errorMessage, setErrorMessage] = useState(null);\n  const [isLoading, setIsLoading] = useState(false);\n  const abortController = React.useRef(null);\n  useEffect(() => {\n    console.log('Client ID:', process.env.REACT_APP_CASPIO_CLIENT_ID.substring(0, 5) + '...');\n    console.log('Client Secret:', process.env.REACT_APP_CASPIO_CLIENT_SECRET.substring(0, 5) + '...');\n  }, []);\n  const refreshToken = useCallback(async () => {\n    try {\n      console.log('Refreshing token...');\n      const response = await axios.post('https://c3eku948.caspio.com/oauth/token', new URLSearchParams({\n        grant_type: 'client_credentials',\n        client_id: process.env.REACT_APP_CASPIO_CLIENT_ID,\n        client_secret: process.env.REACT_APP_CASPIO_CLIENT_SECRET\n      }).toString(), {\n        headers: {\n          'Content-Type': 'application/x-www-form-urlencoded'\n        }\n      });\n      const newAccessToken = response.data.access_token;\n      const expiresIn = response.data.expires_in || 3600;\n      localStorage.setItem('caspioAccessToken', newAccessToken);\n      console.log('Token refreshed successfully');\n      return {\n        newAccessToken,\n        expiresIn\n      };\n    } catch (error) {\n      console.error('Failed to refresh access token:', error);\n      throw error;\n    }\n  }, []);\n  const getAccessToken = useCallback(async () => {\n    let accessToken = localStorage.getItem('caspioAccessToken');\n    if (!accessToken) {\n      console.log('No token found, refreshing...');\n      const {\n        newAccessToken\n      } = await refreshToken();\n      accessToken = newAccessToken;\n    }\n    console.log('Using access token:', accessToken.substring(0, 5) + '...');\n    return accessToken;\n  }, [refreshToken]);\n  const fetchStyles = useCallback(debounce(async (inputValue, callback) => {\n    if (!inputValue) {\n      callback([]);\n      return;\n    }\n    setIsLoading(true);\n    try {\n      var _response$data;\n      const accessToken = await getAccessToken();\n      const queryObject = {\n        STYLE_No: {\n          like: `%${inputValue}%`\n        }\n      };\n      const query = `q=${encodeURIComponent(JSON.stringify(queryObject))}&q.select=STYLE_No&q.distinct=true&q.sort=STYLE_No&q.limit=50`;\n      console.log('Fetching styles with query:', query);\n      const response = await axios.get(`${API_BASE_URL}?${query}`, {\n        headers: {\n          Authorization: `Bearer ${accessToken}`\n        }\n      });\n      const results = ((_response$data = response.data) === null || _response$data === void 0 ? void 0 : _response$data.Result) || [];\n      const options = results.map(item => ({\n        label: item.STYLE_No,\n        value: item.STYLE_No\n      }));\n      callback(options);\n    } catch (err) {\n      console.error('Error fetching styles:', err);\n      setErrorMessage('Failed to load styles. Please try again.');\n      callback([]);\n    } finally {\n      setIsLoading(false);\n    }\n  }, 500), [getAccessToken]);\n  const fetchColors = useCallback(async styleNo => {\n    if (!styleNo) return;\n    setIsLoading(true);\n    try {\n      console.log(`Fetching colors for style: ${styleNo}`);\n      const accessToken = await getAccessToken();\n      let offset = 0;\n      const limit = 1000;\n      let hasMore = true;\n      const colorSet = new Set();\n      const productDetails = {};\n      while (hasMore) {\n        var _response$data2;\n        const queryObject = {\n          STYLE_No: styleNo\n        };\n        const query = `q=${encodeURIComponent(JSON.stringify(queryObject))}&q.select=COLOR_NAME,PRODUCT_TITLE,Price_2_5,Price_6_11,Price_12_23,Price_24_47,Price_48_71,Price_72_plus,Surcharge,Size&q.sort=COLOR_NAME,Size&q.limit=${limit}&q.offset=${offset}`;\n        console.log('Fetching colors with query:', query);\n        const response = await axios.get(`${API_BASE_URL}?${query}`, {\n          headers: {\n            Authorization: `Bearer ${accessToken}`\n          }\n        });\n        const results = ((_response$data2 = response.data) === null || _response$data2 === void 0 ? void 0 : _response$data2.Result) || [];\n        results.forEach(item => {\n          if (item.COLOR_NAME) colorSet.add(item.COLOR_NAME);\n          if (!productDetails[item.COLOR_NAME]) {\n            productDetails[item.COLOR_NAME] = {\n              PRODUCT_TITLE: item.PRODUCT_TITLE,\n              Price_2_5: item.Price_2_5,\n              Price_6_11: item.Price_6_11,\n              Price_12_23: item.Price_12_23,\n              Price_24_47: item.Price_24_47,\n              Price_48_71: item.Price_48_71,\n              Price_72_plus: item.Price_72_plus,\n              Surcharge: item.Surcharge,\n              sizes: {}\n            };\n          }\n          productDetails[item.COLOR_NAME].sizes[item.Size] = {\n            ...item\n          };\n        });\n        if (results.length < limit) {\n          hasMore = false;\n        } else {\n          offset += limit;\n        }\n      }\n      setColors(prevColors => ({\n        ...prevColors,\n        [styleNo]: Array.from(colorSet)\n      }));\n      setProductDatabase(prevDatabase => ({\n        ...prevDatabase,\n        [styleNo]: {\n          colors: productDetails\n        }\n      }));\n      console.log('Fetched colors for style:', styleNo, Array.from(colorSet));\n    } catch (err) {\n      console.error('Error fetching colors:', err);\n      setErrorMessage('Failed to load color options. Please try again later.');\n    } finally {\n      setIsLoading(false);\n    }\n  }, [getAccessToken]);\n  const updateOrder = useCallback((index, field, value) => {\n    console.log(`Updating order ${index}, field: ${field}, value:`, value);\n    setOrders(prevOrders => {\n      const newOrders = [...prevOrders];\n      newOrders[index] = {\n        ...newOrders[index],\n        [field]: value,\n        error: null\n      };\n      if (field === 'STYLE_No') {\n        newOrders[index].COLOR_NAME = '';\n        newOrders[index].quantities = {};\n        if (value && !colors[value]) {\n          fetchColors(value);\n        }\n      } else if (field === 'COLOR_NAME') {\n        newOrders[index].quantities = {};\n      }\n      console.log('Updated orders:', newOrders);\n      return newOrders;\n    });\n  }, [colors, fetchColors]);\n  const calculateOrderTotals = useCallback(() => {\n    console.log('Calculating order totals...');\n    const totalQuantity = orders.reduce((acc, order) => {\n      return acc + Object.values(order.quantities).reduce((sum, qty) => sum + (qty || 0), 0);\n    }, 0);\n    let totalPrice = 0;\n    orders.forEach(order => {\n      var _productDatabase$orde;\n      const productColors = (_productDatabase$orde = productDatabase[order.STYLE_No]) === null || _productDatabase$orde === void 0 ? void 0 : _productDatabase$orde.colors;\n      const colorDetails = productColors === null || productColors === void 0 ? void 0 : productColors[order.COLOR_NAME];\n      if (!colorDetails) return;\n      const basePrice = getPriceForQuantity(colorDetails, totalQuantity);\n      Object.entries(order.quantities).forEach(([size, qty]) => {\n        if (!qty) return;\n        const sizeDetails = colorDetails.sizes[size];\n        if (!sizeDetails) return;\n        const surcharge = LARGE_SIZES.includes(size) ? parseFloat(colorDetails.Surcharge) || 0 : 0;\n        totalPrice += (basePrice + surcharge) * qty;\n      });\n    });\n    console.log('Total quantity:', totalQuantity, 'Total price:', totalPrice);\n    return {\n      quantity: totalQuantity,\n      price: totalPrice\n    };\n  }, [orders, productDatabase]);\n  const totals = useMemo(() => calculateOrderTotals(), [calculateOrderTotals]);\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    className: \"embroidery-calculator\",\n    children: [/*#__PURE__*/_jsxDEV(\"h1\", {\n      children: \"Embroidery Order Form\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 264,\n      columnNumber: 7\n    }, this), errorMessage && /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"error-message\",\n      role: \"alert\",\n      children: [/*#__PURE__*/_jsxDEV(\"strong\", {\n        children: \"Error: \"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 267,\n        columnNumber: 11\n      }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n        children: errorMessage\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 268,\n        columnNumber: 11\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 266,\n      columnNumber: 9\n    }, this), isLoading && /*#__PURE__*/_jsxDEV(LoadingSpinner, {}, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 271,\n      columnNumber: 21\n    }, this), /*#__PURE__*/_jsxDEV(\"table\", {\n      children: [/*#__PURE__*/_jsxDEV(\"thead\", {\n        children: /*#__PURE__*/_jsxDEV(\"tr\", {\n          children: [/*#__PURE__*/_jsxDEV(\"th\", {\n            children: \"Style No\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 275,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(\"th\", {\n            children: \"Color Name\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 276,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(\"th\", {\n            children: \"Product Title\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 277,\n            columnNumber: 13\n          }, this), MAIN_SIZES.map(size => /*#__PURE__*/_jsxDEV(\"th\", {\n            children: size\n          }, size, false, {\n            fileName: _jsxFileName,\n            lineNumber: 279,\n            columnNumber: 15\n          }, this)), /*#__PURE__*/_jsxDEV(\"th\", {\n            children: \"Other Sizes\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 281,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(\"th\", {\n            children: \"Line Qty\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 282,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(\"th\", {\n            children: \"Row Total\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 283,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(\"th\", {\n            children: \"Actions\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 284,\n            columnNumber: 13\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 274,\n          columnNumber: 11\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 273,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"tbody\", {\n        children: orders.map((order, index) => {\n          var _productDatabase$orde2, _colors$order$STYLE_N;\n          const productColors = (_productDatabase$orde2 = productDatabase[order.STYLE_No]) === null || _productDatabase$orde2 === void 0 ? void 0 : _productDatabase$orde2.colors;\n          const colorDetails = productColors === null || productColors === void 0 ? void 0 : productColors[order.COLOR_NAME];\n          const productTitle = (colorDetails === null || colorDetails === void 0 ? void 0 : colorDetails.PRODUCT_TITLE) || '';\n          const sizesAvailable = colorDetails ? Object.keys(colorDetails.sizes) : [];\n          const mainSizesAvailable = sizesAvailable.filter(size => MAIN_SIZES.includes(size));\n          const otherSizesAvailable = sizesAvailable.filter(size => !MAIN_SIZES.includes(size));\n          const lineQuantity = Object.values(order.quantities).reduce((sum, qty) => sum + (qty || 0), 0);\n          const lineTotal = Object.entries(order.quantities).reduce((sum, [size, qty]) => {\n            if (!qty) return sum;\n            const sizeDetails = colorDetails === null || colorDetails === void 0 ? void 0 : colorDetails.sizes[size];\n            if (!sizeDetails) return sum;\n            const basePrice = getPriceForQuantity(colorDetails, totals.quantity);\n            const surcharge = LARGE_SIZES.includes(size) ? parseFloat(colorDetails.Surcharge) || 0 : 0;\n            return sum + (basePrice + surcharge) * qty;\n          }, 0);\n          return /*#__PURE__*/_jsxDEV(\"tr\", {\n            children: [/*#__PURE__*/_jsxDEV(\"td\", {\n              children: /*#__PURE__*/_jsxDEV(AsyncSelect, {\n                cacheOptions: true,\n                loadOptions: fetchStyles,\n                onChange: selectedOption => {\n                  const value = selectedOption ? selectedOption.value : '';\n                  updateOrder(index, 'STYLE_No', value);\n                },\n                value: order.STYLE_No ? {\n                  value: order.STYLE_No,\n                  label: order.STYLE_No\n                } : null,\n                placeholder: \"Enter or select style\",\n                isDisabled: isLoading\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 311,\n                columnNumber: 19\n              }, this)\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 310,\n              columnNumber: 17\n            }, this), /*#__PURE__*/_jsxDEV(\"td\", {\n              children: /*#__PURE__*/_jsxDEV(\"select\", {\n                value: order.COLOR_NAME,\n                onChange: e => updateOrder(index, 'COLOR_NAME', e.target.value),\n                disabled: !order.STYLE_No || isLoading,\n                children: [/*#__PURE__*/_jsxDEV(\"option\", {\n                  value: \"\",\n                  children: \"Select Color\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 333,\n                  columnNumber: 21\n                }, this), (_colors$order$STYLE_N = colors[order.STYLE_No]) === null || _colors$order$STYLE_N === void 0 ? void 0 : _colors$order$STYLE_N.map(color => /*#__PURE__*/_jsxDEV(\"option\", {\n                  value: color,\n                  children: color\n                }, color, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 335,\n                  columnNumber: 23\n                }, this))]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 328,\n                columnNumber: 19\n              }, this)\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 327,\n              columnNumber: 17\n            }, this), /*#__PURE__*/_jsxDEV(\"td\", {\n              children: productTitle\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 341,\n              columnNumber: 17\n            }, this), MAIN_SIZES.map(size => /*#__PURE__*/_jsxDEV(\"td\", {\n              className: LARGE_SIZES.includes(size) ? 'highlight-large-size' : '',\n              children: colorDetails !== null && colorDetails !== void 0 && colorDetails.sizes[size] ? /*#__PURE__*/_jsxDEV(\"div\", {\n                children: [/*#__PURE__*/_jsxDEV(\"input\", {\n                  type: \"number\",\n                  value: order.quantities[size] || '',\n                  onChange: e => updateOrder(index, 'quantities', {\n                    ...order.quantities,\n                    [size]: parseInt(e.target.value) || 0\n                  }),\n                  min: \"0\",\n                  disabled: isLoading\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 346,\n                  columnNumber: 25\n                }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                  className: \"price-info\",\n                  children: colorDetails ? `$${(getPriceForQuantity(colorDetails, totals.quantity) + (LARGE_SIZES.includes(size) ? parseFloat(colorDetails.Surcharge) || 0 : 0)).toFixed(2)}` : ''\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 358,\n                  columnNumber: 25\n                }, this)]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 345,\n                columnNumber: 23\n              }, this) : 'N/A'\n            }, size, false, {\n              fileName: _jsxFileName,\n              lineNumber: 343,\n              columnNumber: 19\n            }, this)), /*#__PURE__*/_jsxDEV(\"td\", {\n              children: otherSizesAvailable.map(size => /*#__PURE__*/_jsxDEV(\"div\", {\n                children: [/*#__PURE__*/_jsxDEV(\"span\", {\n                  children: [size, \": \"]\n                }, void 0, true, {\n                  fileName: _jsxFileName,\n                  lineNumber: 370,\n                  columnNumber: 23\n                }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n                  type: \"number\",\n                  value: order.quantities[size] || '',\n                  onChange: e => updateOrder(index, 'quantities', {\n                    ...order.quantities,\n                    [size]: parseInt(e.target.value) || 0\n                  }),\n                  min: \"0\",\n                  disabled: isLoading\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 371,\n                  columnNumber: 23\n                }, this)]\n              }, size, true, {\n                fileName: _jsxFileName,\n                lineNumber: 369,\n                columnNumber: 21\n              }, this))\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 367,\n              columnNumber: 17\n            }, this), /*#__PURE__*/_jsxDEV(\"td\", {\n              children: lineQuantity\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 386,\n              columnNumber: 17\n            }, this), /*#__PURE__*/_jsxDEV(\"td\", {\n              children: [\"$\", lineTotal.toFixed(2)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 387,\n              columnNumber: 17\n            }, this), /*#__PURE__*/_jsxDEV(\"td\", {\n              children: /*#__PURE__*/_jsxDEV(\"button\", {\n                onClick: () => setOrders(orders.filter((_, i) => i !== index)),\n                disabled: isLoading,\n                children: \"Remove\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 389,\n                columnNumber: 19\n              }, this)\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 388,\n              columnNumber: 17\n            }, this)]\n          }, index, true, {\n            fileName: _jsxFileName,\n            lineNumber: 309,\n            columnNumber: 15\n          }, this);\n        })\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 287,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 272,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n      onClick: () => setOrders([...orders, {\n        STYLE_No: '',\n        COLOR_NAME: '',\n        quantities: {},\n        error: null\n      }]),\n      disabled: isLoading,\n      children: \"Add Line\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 398,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n      onClick: () => console.log('Submit order:', orders),\n      disabled: isLoading,\n      children: \"Submit Order\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 406,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      children: [/*#__PURE__*/_jsxDEV(\"p\", {\n        children: [\"Total Quantity: \", totals.quantity]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 410,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n        children: [\"Total Price: $\", totals.price.toFixed(2)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 411,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 409,\n      columnNumber: 7\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 263,\n    columnNumber: 5\n  }, this);\n}\n_s(EmbroideryCalculator, \"/dhUkEvsObIL3bkdoekC+FoBGZ0=\");\n_c2 = EmbroideryCalculator;\nvar _c, _c2;\n$RefreshReg$(_c, \"LoadingSpinner\");\n$RefreshReg$(_c2, \"EmbroideryCalculator\");","map":{"version":3,"names":["React","useState","useCallback","useMemo","useEffect","axios","AsyncSelect","debounce","jsxDEV","_jsxDEV","API_BASE_URL","MAIN_SIZES","LARGE_SIZES","LoadingSpinner","className","children","fileName","_jsxFileName","lineNumber","columnNumber","_c","getPriceForQuantity","product","totalQuantity","console","log","parseFloat","Price_72_plus","Price_48_71","Price_24_47","Price_12_23","Price_6_11","Price_2_5","EmbroideryCalculator","_s","productDatabase","setProductDatabase","orders","setOrders","STYLE_No","COLOR_NAME","quantities","error","colors","setColors","errorMessage","setErrorMessage","isLoading","setIsLoading","abortController","useRef","process","env","REACT_APP_CASPIO_CLIENT_ID","substring","REACT_APP_CASPIO_CLIENT_SECRET","refreshToken","response","post","URLSearchParams","grant_type","client_id","client_secret","toString","headers","newAccessToken","data","access_token","expiresIn","expires_in","localStorage","setItem","getAccessToken","accessToken","getItem","fetchStyles","inputValue","callback","_response$data","queryObject","like","query","encodeURIComponent","JSON","stringify","get","Authorization","results","Result","options","map","item","label","value","err","fetchColors","styleNo","offset","limit","hasMore","colorSet","Set","productDetails","_response$data2","forEach","add","PRODUCT_TITLE","Surcharge","sizes","Size","length","prevColors","Array","from","prevDatabase","updateOrder","index","field","prevOrders","newOrders","calculateOrderTotals","reduce","acc","order","Object","values","sum","qty","totalPrice","_productDatabase$orde","productColors","colorDetails","basePrice","entries","size","sizeDetails","surcharge","includes","quantity","price","totals","role","_productDatabase$orde2","_colors$order$STYLE_N","productTitle","sizesAvailable","keys","mainSizesAvailable","filter","otherSizesAvailable","lineQuantity","lineTotal","cacheOptions","loadOptions","onChange","selectedOption","placeholder","isDisabled","e","target","disabled","color","type","parseInt","min","toFixed","onClick","_","i","_c2","$RefreshReg$"],"sources":["C:/Users/erik/Downloads/embroidered-order-form/src/components/EmbroideryCalculator.js"],"sourcesContent":["import React, { useState, useCallback, useMemo, useEffect } from 'react';\r\nimport axios from 'axios';\r\nimport AsyncSelect from 'react-select/async';\r\nimport debounce from 'lodash/debounce';\r\nimport './EmbroideryCalculator.css';\r\n\r\nconst API_BASE_URL = 'https://c3eku948.caspio.com/rest/v2/views/Heroku/records';\r\nconst MAIN_SIZES = ['S', 'M', 'L', 'XL', '2XL', '3XL'];\r\nconst LARGE_SIZES = ['2XL', '3XL', '4XL', '5XL', '6XL'];\r\n\r\nconst LoadingSpinner = () => (\r\n  <div className=\"loading-spinner\">\r\n    <div className=\"spinner\"></div>\r\n  </div>\r\n);\r\n\r\nconst getPriceForQuantity = (product, totalQuantity) => {\r\n  console.log('Calculating price for quantity:', totalQuantity);\r\n  if (totalQuantity >= 72) return parseFloat(product.Price_72_plus) || 0;\r\n  if (totalQuantity >= 48) return parseFloat(product.Price_48_71) || 0;\r\n  if (totalQuantity >= 24) return parseFloat(product.Price_24_47) || 0;\r\n  if (totalQuantity >= 12) return parseFloat(product.Price_12_23) || 0;\r\n  if (totalQuantity >= 6) return parseFloat(product.Price_6_11) || 0;\r\n  return parseFloat(product.Price_2_5) || 0;\r\n};\r\n\r\nexport default function EmbroideryCalculator() {\r\n  const [productDatabase, setProductDatabase] = useState({});\r\n  const [orders, setOrders] = useState([\r\n    {\r\n      STYLE_No: '',\r\n      COLOR_NAME: '',\r\n      quantities: {},\r\n      error: null,\r\n    },\r\n  ]);\r\n  const [colors, setColors] = useState({});\r\n  const [errorMessage, setErrorMessage] = useState(null);\r\n  const [isLoading, setIsLoading] = useState(false);\r\n\r\n  const abortController = React.useRef(null);\r\n\r\n  useEffect(() => {\r\n    console.log('Client ID:', process.env.REACT_APP_CASPIO_CLIENT_ID.substring(0, 5) + '...');\r\n    console.log('Client Secret:', process.env.REACT_APP_CASPIO_CLIENT_SECRET.substring(0, 5) + '...');\r\n  }, []);\r\n\r\n  const refreshToken = useCallback(async () => {\r\n    try {\r\n      console.log('Refreshing token...');\r\n      const response = await axios.post(\r\n        'https://c3eku948.caspio.com/oauth/token',\r\n        new URLSearchParams({\r\n          grant_type: 'client_credentials',\r\n          client_id: process.env.REACT_APP_CASPIO_CLIENT_ID,\r\n          client_secret: process.env.REACT_APP_CASPIO_CLIENT_SECRET,\r\n        }).toString(),\r\n        {\r\n          headers: {\r\n            'Content-Type': 'application/x-www-form-urlencoded',\r\n          },\r\n        }\r\n      );\r\n\r\n      const newAccessToken = response.data.access_token;\r\n      const expiresIn = response.data.expires_in || 3600;\r\n\r\n      localStorage.setItem('caspioAccessToken', newAccessToken);\r\n      console.log('Token refreshed successfully');\r\n\r\n      return { newAccessToken, expiresIn };\r\n    } catch (error) {\r\n      console.error('Failed to refresh access token:', error);\r\n      throw error;\r\n    }\r\n  }, []);\r\n\r\n  const getAccessToken = useCallback(async () => {\r\n    let accessToken = localStorage.getItem('caspioAccessToken');\r\n\r\n    if (!accessToken) {\r\n      console.log('No token found, refreshing...');\r\n      const { newAccessToken } = await refreshToken();\r\n      accessToken = newAccessToken;\r\n    }\r\n\r\n    console.log('Using access token:', accessToken.substring(0, 5) + '...');\r\n    return accessToken;\r\n  }, [refreshToken]);\r\n\r\n  const fetchStyles = useCallback(\r\n    debounce(async (inputValue, callback) => {\r\n      if (!inputValue) {\r\n        callback([]);\r\n        return;\r\n      }\r\n\r\n      setIsLoading(true);\r\n      try {\r\n        const accessToken = await getAccessToken();\r\n        const queryObject = {\r\n          STYLE_No: { like: `%${inputValue}%` },\r\n        };\r\n        const query = `q=${encodeURIComponent(JSON.stringify(queryObject))}&q.select=STYLE_No&q.distinct=true&q.sort=STYLE_No&q.limit=50`;\r\n        console.log('Fetching styles with query:', query);\r\n        const response = await axios.get(`${API_BASE_URL}?${query}`, {\r\n          headers: {\r\n            Authorization: `Bearer ${accessToken}`,\r\n          },\r\n        });\r\n\r\n        const results = response.data?.Result || [];\r\n        const options = results.map((item) => ({\r\n          label: item.STYLE_No,\r\n          value: item.STYLE_No,\r\n        }));\r\n        callback(options);\r\n      } catch (err) {\r\n        console.error('Error fetching styles:', err);\r\n        setErrorMessage('Failed to load styles. Please try again.');\r\n        callback([]);\r\n      } finally {\r\n        setIsLoading(false);\r\n      }\r\n    }, 500),\r\n    [getAccessToken]\r\n  );\r\n\r\n  const fetchColors = useCallback(async (styleNo) => {\r\n    if (!styleNo) return;\r\n\r\n    setIsLoading(true);\r\n    try {\r\n      console.log(`Fetching colors for style: ${styleNo}`);\r\n      const accessToken = await getAccessToken();\r\n      let offset = 0;\r\n      const limit = 1000;\r\n      let hasMore = true;\r\n      const colorSet = new Set();\r\n      const productDetails = {};\r\n\r\n      while (hasMore) {\r\n        const queryObject = {\r\n          STYLE_No: styleNo,\r\n        };\r\n        const query = `q=${encodeURIComponent(JSON.stringify(queryObject))}&q.select=COLOR_NAME,PRODUCT_TITLE,Price_2_5,Price_6_11,Price_12_23,Price_24_47,Price_48_71,Price_72_plus,Surcharge,Size&q.sort=COLOR_NAME,Size&q.limit=${limit}&q.offset=${offset}`;\r\n        console.log('Fetching colors with query:', query);\r\n        const response = await axios.get(`${API_BASE_URL}?${query}`, {\r\n          headers: {\r\n            Authorization: `Bearer ${accessToken}`,\r\n          },\r\n        });\r\n\r\n        const results = response.data?.Result || [];\r\n        results.forEach((item) => {\r\n          if (item.COLOR_NAME) colorSet.add(item.COLOR_NAME);\r\n          if (!productDetails[item.COLOR_NAME]) {\r\n            productDetails[item.COLOR_NAME] = {\r\n              PRODUCT_TITLE: item.PRODUCT_TITLE,\r\n              Price_2_5: item.Price_2_5,\r\n              Price_6_11: item.Price_6_11,\r\n              Price_12_23: item.Price_12_23,\r\n              Price_24_47: item.Price_24_47,\r\n              Price_48_71: item.Price_48_71,\r\n              Price_72_plus: item.Price_72_plus,\r\n              Surcharge: item.Surcharge,\r\n              sizes: {},\r\n            };\r\n          }\r\n          productDetails[item.COLOR_NAME].sizes[item.Size] = {\r\n            ...item,\r\n          };\r\n        });\r\n\r\n        if (results.length < limit) {\r\n          hasMore = false;\r\n        } else {\r\n          offset += limit;\r\n        }\r\n      }\r\n\r\n      setColors((prevColors) => ({\r\n        ...prevColors,\r\n        [styleNo]: Array.from(colorSet),\r\n      }));\r\n\r\n      setProductDatabase((prevDatabase) => ({\r\n        ...prevDatabase,\r\n        [styleNo]: {\r\n          colors: productDetails,\r\n        },\r\n      }));\r\n\r\n      console.log('Fetched colors for style:', styleNo, Array.from(colorSet));\r\n    } catch (err) {\r\n      console.error('Error fetching colors:', err);\r\n      setErrorMessage('Failed to load color options. Please try again later.');\r\n    } finally {\r\n      setIsLoading(false);\r\n    }\r\n  }, [getAccessToken]);\r\n\r\n  const updateOrder = useCallback(\r\n    (index, field, value) => {\r\n      console.log(`Updating order ${index}, field: ${field}, value:`, value);\r\n      setOrders((prevOrders) => {\r\n        const newOrders = [...prevOrders];\r\n        newOrders[index] = {\r\n          ...newOrders[index],\r\n          [field]: value,\r\n          error: null,\r\n        };\r\n\r\n        if (field === 'STYLE_No') {\r\n          newOrders[index].COLOR_NAME = '';\r\n          newOrders[index].quantities = {};\r\n          if (value && !colors[value]) {\r\n            fetchColors(value);\r\n          }\r\n        } else if (field === 'COLOR_NAME') {\r\n          newOrders[index].quantities = {};\r\n        }\r\n\r\n        console.log('Updated orders:', newOrders);\r\n        return newOrders;\r\n      });\r\n    },\r\n    [colors, fetchColors]\r\n  );\r\n\r\n  const calculateOrderTotals = useCallback(() => {\r\n    console.log('Calculating order totals...');\r\n    const totalQuantity = orders.reduce((acc, order) => {\r\n      return acc + Object.values(order.quantities).reduce((sum, qty) => sum + (qty || 0), 0);\r\n    }, 0);\r\n\r\n    let totalPrice = 0;\r\n\r\n    orders.forEach((order) => {\r\n      const productColors = productDatabase[order.STYLE_No]?.colors;\r\n      const colorDetails = productColors?.[order.COLOR_NAME];\r\n      if (!colorDetails) return;\r\n\r\n      const basePrice = getPriceForQuantity(colorDetails, totalQuantity);\r\n\r\n      Object.entries(order.quantities).forEach(([size, qty]) => {\r\n        if (!qty) return;\r\n        const sizeDetails = colorDetails.sizes[size];\r\n        if (!sizeDetails) return;\r\n\r\n        const surcharge = LARGE_SIZES.includes(size) ? parseFloat(colorDetails.Surcharge) || 0 : 0;\r\n        totalPrice += (basePrice + surcharge) * qty;\r\n      });\r\n    });\r\n\r\n    console.log('Total quantity:', totalQuantity, 'Total price:', totalPrice);\r\n    return { quantity: totalQuantity, price: totalPrice };\r\n  }, [orders, productDatabase]);\r\n\r\n  const totals = useMemo(() => calculateOrderTotals(), [calculateOrderTotals]);\r\n\r\n  return (\r\n    <div className=\"embroidery-calculator\">\r\n      <h1>Embroidery Order Form</h1>\r\n      {errorMessage && (\r\n        <div className=\"error-message\" role=\"alert\">\r\n          <strong>Error: </strong>\r\n          <span>{errorMessage}</span>\r\n        </div>\r\n      )}\r\n      {isLoading && <LoadingSpinner />}\r\n      <table>\r\n        <thead>\r\n          <tr>\r\n            <th>Style No</th>\r\n            <th>Color Name</th>\r\n            <th>Product Title</th>\r\n            {MAIN_SIZES.map((size) => (\r\n              <th key={size}>{size}</th>\r\n            ))}\r\n            <th>Other Sizes</th>\r\n            <th>Line Qty</th>\r\n            <th>Row Total</th>\r\n            <th>Actions</th>\r\n          </tr>\r\n        </thead>\r\n        <tbody>\r\n          {orders.map((order, index) => {\r\n            const productColors = productDatabase[order.STYLE_No]?.colors;\r\n            const colorDetails = productColors?.[order.COLOR_NAME];\r\n            const productTitle = colorDetails?.PRODUCT_TITLE || '';\r\n            const sizesAvailable = colorDetails ? Object.keys(colorDetails.sizes) : [];\r\n            const mainSizesAvailable = sizesAvailable.filter((size) => MAIN_SIZES.includes(size));\r\n            const otherSizesAvailable = sizesAvailable.filter((size) => !MAIN_SIZES.includes(size));\r\n\r\n            const lineQuantity = Object.values(order.quantities).reduce((sum, qty) => sum + (qty || 0), 0);\r\n\r\n            const lineTotal = Object.entries(order.quantities).reduce((sum, [size, qty]) => {\r\n              if (!qty) return sum;\r\n              const sizeDetails = colorDetails?.sizes[size];\r\n              if (!sizeDetails) return sum;\r\n\r\n              const basePrice = getPriceForQuantity(colorDetails, totals.quantity);\r\n              const surcharge = LARGE_SIZES.includes(size) ? parseFloat(colorDetails.Surcharge) || 0 : 0;\r\n              return sum + (basePrice + surcharge) * qty;\r\n            }, 0);\r\n\r\n            return (\r\n              <tr key={index}>\r\n                <td>\r\n                  <AsyncSelect\r\n                    cacheOptions\r\n                    loadOptions={fetchStyles}\r\n                    onChange={(selectedOption) => {\r\n                      const value = selectedOption ? selectedOption.value : '';\r\n                      updateOrder(index, 'STYLE_No', value);\r\n                    }}\r\n                    value={\r\n                      order.STYLE_No\r\n                        ? { value: order.STYLE_No, label: order.STYLE_No }\r\n                        : null\r\n                    }\r\n                    placeholder=\"Enter or select style\"\r\n                    isDisabled={isLoading}\r\n                  />\r\n                </td>\r\n                <td>\r\n                  <select\r\n                    value={order.COLOR_NAME}\r\n                    onChange={(e) => updateOrder(index, 'COLOR_NAME', e.target.value)}\r\n                    disabled={!order.STYLE_No || isLoading}\r\n                  >\r\n                    <option value=\"\">Select Color</option>\r\n                    {colors[order.STYLE_No]?.map((color) => (\r\n                      <option key={color} value={color}>\r\n                        {color}\r\n                      </option>\r\n                    ))}\r\n                  </select>\r\n                </td>\r\n                <td>{productTitle}</td>\r\n                {MAIN_SIZES.map((size) => (\r\n                  <td key={size} className={LARGE_SIZES.includes(size) ? 'highlight-large-size' : ''}>\r\n                    {colorDetails?.sizes[size] ? (\r\n                      <div>\r\n                        <input\r\n                          type=\"number\"\r\n                          value={order.quantities[size] || ''}\r\n                          onChange={(e) =>\r\n                            updateOrder(index, 'quantities', {\r\n                              ...order.quantities,\r\n                              [size]: parseInt(e.target.value) || 0,\r\n                            })\r\n                          }\r\n                          min=\"0\"\r\n                          disabled={isLoading}\r\n                        />\r\n                        <div className=\"price-info\">\r\n                          {colorDetails ? `$${(getPriceForQuantity(colorDetails, totals.quantity) + (LARGE_SIZES.includes(size) ? parseFloat(colorDetails.Surcharge) || 0 : 0)).toFixed(2)}` : ''}\r\n                        </div>\r\n                      </div>\r\n                    ) : (\r\n                      'N/A'\r\n                    )}\r\n                  </td>\r\n                ))}\r\n                <td>\r\n                  {otherSizesAvailable.map((size) => (\r\n                    <div key={size}>\r\n                      <span>{size}: </span>\r\n                      <input\r\n                        type=\"number\"\r\n                        value={order.quantities[size] || ''}\r\n                        onChange={(e) =>\r\n                          updateOrder(index, 'quantities', {\r\n                            ...order.quantities,\r\n                            [size]: parseInt(e.target.value) || 0,\r\n                          })\r\n                        }\r\n                        min=\"0\"\r\n                        disabled={isLoading}\r\n                      />\r\n                    </div>\r\n                  ))}\r\n                </td>\r\n                <td>{lineQuantity}</td>\r\n                <td>${lineTotal.toFixed(2)}</td>\r\n                <td>\r\n                  <button onClick={() => setOrders(orders.filter((_, i) => i !== index))} disabled={isLoading}>\r\n                    Remove\r\n                  </button>\r\n                </td>\r\n              </tr>\r\n            );\r\n          })}\r\n        </tbody>\r\n      </table>\r\n      <button\r\n        onClick={() =>\r\n          setOrders([...orders, { STYLE_No: '', COLOR_NAME: '', quantities: {}, error: null }])\r\n        }\r\n        disabled={isLoading}\r\n      >\r\n        Add Line\r\n      </button>\r\n      <button onClick={() => console.log('Submit order:', orders)} disabled={isLoading}>\r\n        Submit Order\r\n      </button>\r\n      <div>\r\n        <p>Total Quantity: {totals.quantity}</p>\r\n        <p>Total Price: ${totals.price.toFixed(2)}</p>\r\n      </div>\r\n    </div>\r\n  );\r\n}"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}